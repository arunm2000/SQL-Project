<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/Mandeep Matharu/Google Drive/Graduate Jobs/Data Science Projects/Data Science Project #2/chinook.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="150"/><column_width id="3" width="6053"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,6:maintracks"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="albums" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="100"/><column index="2" value="300"/><column index="3" value="90"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="artists" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="90"/><column index="2" value="300"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customers" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="131"/><column index="2" value="115"/><column index="3" value="125"/><column index="4" value="300"/><column index="5" value="300"/><column index="6" value="199"/><column index="7" value="65"/><column index="8" value="149"/><column index="9" value="123"/><column index="10" value="199"/><column index="11" value="189"/><column index="12" value="282"/><column index="13" value="156"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="employees" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="133"/><column index="2" value="111"/><column index="3" value="115"/><column index="4" value="187"/><column index="5" value="115"/><column index="6" value="195"/><column index="7" value="195"/><column index="8" value="275"/><column index="9" value="102"/><column index="10" value="65"/><column index="11" value="92"/><column index="12" value="123"/><column index="13" value="178"/><column index="14" value="178"/><column index="15" value="256"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="genres" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="96"/><column index="2" value="172"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="invoice_items" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="153"/><column index="2" value="111"/><column index="3" value="91"/><column index="4" value="105"/><column index="5" value="99"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="invoices" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="111"/><column index="2" value="131"/><column index="3" value="195"/><column index="4" value="300"/><column index="5" value="199"/><column index="6" value="129"/><column index="7" value="156"/><column index="8" value="187"/><column index="9" value="62"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="media_types" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="145"/><column index="2" value="253"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="playlist_track" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="108"/><column index="2" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="playlists" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="108"/><column index="2" value="237"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sqlite_sequence" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="129"/><column index="2" value="61"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sqlite_stat1" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="129"/><column index="2" value="300"/><column index="3" value="107"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="tracks" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="91"/><column index="2" value="300"/><column index="3" value="100"/><column index="4" value="145"/><column index="5" value="96"/><column index="6" value="300"/><column index="7" value="135"/><column index="8" value="95"/><column index="9" value="105"/></column_widths><filter_values><column index="3" value="14"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="Playlist Numbers.sql">/*Which tracks appeared in the most playlists?
	How many playlists did they appear in?*/

SELECT tracks.name AS 'Track Name',
	COUNT (*) AS 'Number of Playlists'
FROM playlist_track
JOIN tracks
ON playlist_track.TrackId = tracks.TrackId
GROUP BY playlist_track.TrackId
ORDER BY 2 DESC
Limit 50;</sql><sql name="Revenue Analysis.sql">/*Which Track generated the most revenue?*/

SELECT tracks.name AS 'Track Name',
	invoice_items.UnitPrice * SUM(Quantity) AS 'Total Revenue'
FROM invoice_items
JOIN tracks
ON tracks.TrackId = invoice_items.TrackId
GROUP BY tracks.TrackId
ORDER BY 2 DESC
LIMIT 10;

/*Which Albums generated the most revenue*/

SELECT albums.Title AS 'Album Name',
	invoice_items.UnitPrice * SUM(Quantity) AS 'Total Revenue'
FROM invoice_items
JOIN tracks
ON tracks.TrackId = invoice_items.TrackId
JOIN albums
ON albums.AlbumId = tracks.AlbumId
GROUP BY albums.AlbumId
ORDER BY 2 DESC
LIMIT 10;

/*Which Genre generated the most revenue?*/

SELECT genres.name AS 'Genre',
	invoice_items.UnitPrice * SUM(Quantity) AS 'Total Revenue'
FROM invoice_items
JOIN tracks
ON invoice_items.TrackId = tracks.TrackId
JOIN genres
ON tracks.GenreId = genres.GenreId
GROUP BY genres.Name
ORDER BY 2 DESC;

/*Which countries have the highest sales revenue*/

SELECT BillingCountry AS 'Country',
	SUM(total) AS 'Total Revenue'
FROM invoices
GROUP BY BillingCountry
ORDER BY 2 DESC;

/*What percent of total revenue does each country make up?*/

SELECT invoices.BillingCountry AS 'Country',
	ROUND((SUM(invoices.total)/
	(SELECT SUM(invoices.total) FROM invoices))*100, 2)
	AS '% of Total Revenue'
FROM invoices
GROUP BY invoices.BillingCountry
ORDER BY 2 DESC;

/*How many customers did each employee support?*/

SELECT employees.EmployeeId, employees.FirstName,
	employees.LastName, COUNT(SupportRepId) AS '# of Customers Supported'
FROM customers
JOIN employees
ON customers.SupportRepId = employees.EmployeeId
GROUP BY employees.EmployeeId;

/*What is their average revenue for each sale?*/

SELECT employees.EmployeeId, employees.FirstName,
	employees.LastName, ROUND(AVG(invoices.total),2) AS 'Average Revenue per Sale'
FROM invoices
JOIN customers
ON invoices.CustomerId = customers.CustomerId
JOIN employees
ON customers.SupportRepId = employees.EmployeeId
GROUP BY employees.EmployeeId
ORDER BY 4 DESC;

/*What is their total sales revenue?*/

SELECT employees.EmployeeId, employees.FirstName,
	employees.LastName, ROUND(SUM(invoices.total),2) AS 'Total Revenue'
FROM invoices
JOIN customers
ON invoices.CustomerId = customers.CustomerId
JOIN employees
ON customers.SupportRepId = employees.EmployeeId
GROUP BY employees.EmployeeId
ORDER BY 4 DESC;</sql><sql name="Challenges.sql">/*Do longer or shorter length albums tend to generate more revenue?*/

WITH album_length
AS (SELECT albums.AlbumId,albums.Title, 
	COUNT(tracks.name)AS 'Number of Tracks'
FROM tracks
JOIN albums
ON tracks.AlbumId = albums.AlbumId
GROUP BY albums.Title)

SELECT *
FROM album_length;
</sql><current_tab id="2"/></tab_sql></sqlb_project>
